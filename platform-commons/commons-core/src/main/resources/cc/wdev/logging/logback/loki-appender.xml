<?xml version="1.0" encoding="UTF-8"?>
<included>
    <springProperty name="LOG_APP_NAME" source="spring.application.name" scope="context" defaultValue="app-server"/>

    <springProperty name="LOG_LOKI_URL" source="logging.loki.url" scop="context" defaultValue="http://localhost:3100/loki/api/v1/push"/>

    <springProperty name="LOG_LOKI_USER" source="logging.loki.user" scop="context" defaultValue=""/>

    <springProperty name="LOG_LOKI_PASS" source="logging.loki.pass" scop="context" defaultValue=""/>

    <appender name="LOKI" class="com.github.loki4j.logback.Loki4jAppender">
        <simpleMessage class="com.github.loki4j.logback.JsonLayout"/>
        <http>
            <url>${LOG_LOKI_URL}</url>
            <auth>
                <username>${LOG_LOKI_USER}</username>
                <password>${LOG_LOKI_PASS}</password>
            </auth>
            <requestTimeoutMs>15000</requestTimeoutMs>
        </http>
        <batch>
            <maxBytes>65536</maxBytes>
            <drainOnStop>false</drainOnStop>
        </batch>
        <verbose>true</verbose>
        <labels>
            app = ${LOG_APP_NAME}
            host = ${HOSTNAME}
            level = %level
        </labels>
    </appender>
</included>
